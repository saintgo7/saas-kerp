# K-ERP v0.2 - 기술 비교 분석

**문서 버전**: 0.2.0
**작성일**: 2026-01-16
**상태**: 검토 대기

---

## 목차

1. [Go vs Python 종합 비교](#1-go-vs-python-종합-비교)
2. [한국 정부기관 연동 분석](#2-한국-정부기관-연동-분석)
3. [하이브리드 아키텍처 타당성](#3-하이브리드-아키텍처-타당성)
4. [결론 및 권고사항](#4-결론-및-권고사항)

---

## 1. Go vs Python 종합 비교

### 1.1 언어 특성 비교

| 항목 | Go | Python |
|------|-----|--------|
| 타입 시스템 | 정적 타입 | 동적 타입 |
| 컴파일 | 네이티브 바이너리 | 인터프리터 |
| 동시성 | Goroutine (경량) | asyncio, threading |
| 메모리 관리 | GC (짧은 pause) | GC (긴 pause 가능) |
| 실행 속도 | 빠름 (C/C++ 급) | 느림 (10-100배) |
| 메모리 사용량 | 낮음 | 높음 |
| 학습 곡선 | 낮음 | 매우 낮음 |
| 생태계 크기 | 중간 | 매우 큼 |

### 1.2 성능 벤치마크

**JSON 직렬화/역직렬화 (100만 건)**

| 언어 | 시간 | 메모리 |
|------|------|--------|
| Go (encoding/json) | 1.2초 | 50MB |
| Go (json-iterator) | 0.8초 | 45MB |
| Python (json) | 12초 | 150MB |
| Python (orjson) | 2.5초 | 80MB |

**HTTP 서버 처리량 (wrk, 10초)**

| 언어/프레임워크 | RPS | 평균 지연 |
|-----------------|-----|----------|
| Go (Gin) | 150,000 | 0.2ms |
| Go (net/http) | 130,000 | 0.3ms |
| Python (FastAPI) | 8,000 | 3.5ms |
| Python (Flask) | 2,000 | 15ms |

**gRPC 처리량**

| 언어 | RPS | p99 지연 |
|------|-----|----------|
| Go | 100,000 | 1ms |
| Python (grpcio) | 15,000 | 8ms |

### 1.3 암호화 라이브러리 지원

| 알고리즘 | Go | Python |
|----------|-----|--------|
| AES-256 | crypto/aes (표준) | pycryptodome |
| RSA | crypto/rsa (표준) | cryptography |
| SEED-CBC | **미지원** | pycryptodome, kisa-seed |
| ARIA-CBC | **미지원** | pycryptodome |
| PKCS#7 서명 | go/crypto (제한적) | cryptography |

### 1.4 웹 스크래핑 도구

| 도구 | Go | Python |
|------|-----|--------|
| HTTP Client | net/http, resty | httpx, requests |
| HTML Parser | goquery | BeautifulSoup, lxml |
| 브라우저 자동화 | chromedp, rod | Playwright, Selenium |
| JavaScript 실행 | 제한적 | Playwright (완벽) |
| 한글 인코딩 | 수동 처리 | 자동 처리 |

---

## 2. 한국 정부기관 연동 분석

### 2.1 기관별 기술 요구사항

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    한국 정부기관 기술 요구사항 분석                          │
├───────────────┬────────────┬────────────┬───────────────┬───────────────────┤
│ 기관          │ 연동 방식  │ 암호화     │ 인코딩        │ Go 구현 가능성    │
├───────────────┼────────────┼────────────┼───────────────┼───────────────────┤
│ 홈택스        │ Web+SEED   │ SEED-CBC   │ EUC-KR        │ 불가 (SEED 미지원)│
│ 국민연금      │ EDI+SEED   │ SEED-CBC   │ EUC-KR        │ 불가 (SEED 미지원)│
│ 건강보험      │ EDI+ARIA   │ ARIA-CBC   │ UTF-8         │ 불가 (ARIA 미지원)│
│ 고용보험      │ Web+SEED   │ SEED-CBC   │ EUC-KR        │ 불가 (SEED 미지원)│
│ 산재보험      │ Web+SEED   │ SEED-CBC   │ EUC-KR        │ 불가 (SEED 미지원)│
│ Popbill ASP   │ REST API   │ 없음       │ UTF-8         │ 가능 (권장)       │
│ 국세청 API    │ REST API   │ 없음       │ UTF-8         │ 가능 (권장)       │
└───────────────┴────────────┴────────────┴───────────────┴───────────────────┘
```

### 2.2 SEED 암호화 구현 비용 분석

**Go로 SEED 직접 구현 시:**

| 항목 | 예상 비용 |
|------|----------|
| SEED 알고리즘 구현 | 2주 |
| CBC 모드 구현 | 1주 |
| PKCS7 패딩 구현 | 0.5주 |
| 테스트 및 검증 | 1주 |
| 보안 감사 | 필요 (외부) |
| **총 기간** | **4.5주 이상** |

**Python 라이브러리 사용 시:**

| 항목 | 예상 비용 |
|------|----------|
| pycryptodome 설치 | 1시간 |
| 암호화 모듈 작성 | 1일 |
| 테스트 | 1일 |
| **총 기간** | **2-3일** |

### 2.3 EDI 메시지 처리 비교

**EDI 고정 길이 포맷 처리**

Go 구현:
```go
// 수동 파싱 필요
type NPSRecord struct {
    RecordType [2]byte
    TxCode     [4]byte
    SendDate   [8]byte
    // ... 각 필드 수동 정의
}

func ParseNPSRecord(data []byte) (*NPSRecord, error) {
    if len(data) < 250 {
        return nil, errors.New("invalid record length")
    }
    r := &NPSRecord{}
    copy(r.RecordType[:], data[0:2])
    copy(r.TxCode[:], data[2:6])
    // ... 수동 복사
    return r, nil
}
```

Python 구현:
```python
# 간결한 처리
import struct

class NPSRecord:
    FORMAT = "2s4s8s6s10s10s"  # struct format

    @classmethod
    def parse(cls, data: bytes) -> "NPSRecord":
        fields = struct.unpack(cls.FORMAT, data[:40])
        return cls(*fields)

    def to_bytes(self) -> bytes:
        return struct.pack(self.FORMAT, *self.fields)
```

### 2.4 웹 스크래핑 비교

**홈택스 로그인 구현**

Go (chromedp):
```go
// JavaScript 실행 및 인증서 처리에 제한
err := chromedp.Run(ctx,
    chromedp.Navigate(loginURL),
    chromedp.WaitVisible("#loginBtn"),
    chromedp.Click("#certLogin"),
    // 인증서 파일 업로드 - 복잡
    // SEED 암호화 처리 - 불가능
)
```

Python (Playwright):
```python
# JavaScript 완전 지원
async with async_playwright() as p:
    browser = await p.chromium.launch()
    page = await browser.new_page()
    await page.goto(login_url)

    # JavaScript로 인증서 처리
    await page.evaluate("""
        async (certData) => {
            // 홈택스 내부 함수 호출 가능
            return await window.certLogin(certData);
        }
    """, cert_data)
```

---

## 3. 하이브리드 아키텍처 타당성

### 3.1 아키텍처 결정 매트릭스

| 평가 항목 | Go Only | Python Only | Hybrid |
|-----------|---------|-------------|--------|
| 한국 암호화 지원 | 0 | 5 | 5 |
| API 성능 | 5 | 2 | 5 |
| 개발 속도 | 3 | 5 | 4 |
| 유지보수성 | 4 | 3 | 3 |
| 운영 복잡도 | 5 | 5 | 3 |
| 확장성 | 5 | 3 | 5 |
| **총점** | **22** | **23** | **25** |

*점수: 0(매우 나쁨) ~ 5(매우 좋음)*

### 3.2 역할 분담

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         Go + Python 역할 분담                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Go API Server (90%)                 Python Services (10%)                  │
│  ├── REST API                        ├── SEED/ARIA 암호화                   │
│  ├── 비즈니스 로직                   ├── 홈택스 스크래핑                    │
│  │   ├── 회계                        ├── EDI 메시지 생성/파싱               │
│  │   ├── 급여 계산                   ├── 4대보험 웹 자동화                  │
│  │   ├── 구매/판매/재고              └── PKCS#7 전자서명                    │
│  │   └── 세금계산서 (Provider)                                              │
│  ├── 데이터베이스 (GORM, sqlc)                                              │
│  ├── 캐시 (Redis)                                                           │
│  ├── 이벤트 (NATS)                                                          │
│  ├── 인증/인가 (JWT)                                                        │
│  └── gRPC Client                                                            │
│                                                                             │
│  통신: gRPC (HTTP/2, Protocol Buffers)                                      │
│  장점: 타입 안전성, 고성능, 양방향 스트리밍                                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.3 장단점 분석

**장점:**

1. **기술적 불가능 해결**: SEED/ARIA 암호화 문제 해결
2. **성능 유지**: 핵심 API는 Go로 고성능 유지
3. **개발 기간 단축**: Python 라이브러리로 3-4주 절약
4. **유연성**: 각 언어의 강점 활용
5. **리스크 분산**: 홈택스 변경 시 Python만 수정

**단점:**

1. **운영 복잡도 증가**: 2개 런타임 관리
2. **개발자 요구사항**: Go + Python 모두 숙련 필요
3. **디버깅 복잡도**: 서비스 간 통신 추적
4. **배포 복잡도**: 2종류 컨테이너 관리

### 3.4 운영 복잡도 완화 방안

| 복잡도 요소 | 완화 방안 |
|------------|----------|
| 다중 런타임 | Kubernetes로 통합 관리 |
| 로깅 분산 | 중앙 집중 로깅 (Loki) |
| 모니터링 | Prometheus + Grafana |
| 배포 | Helm Chart 통합 |
| 디버깅 | 분산 추적 (Jaeger) |

### 3.5 대안 비교

**대안 1: Go Only + SEED 직접 구현**
- 장점: 단일 언어
- 단점: 개발 기간 증가 (4-5주), 보안 리스크
- 추천: 비추천

**대안 2: Python Only**
- 장점: 모든 암호화 지원, 단일 언어
- 단점: 성능 저하 (API 10배 느림), 확장성 제한
- 추천: 소규모 프로젝트에만 적합

**대안 3: CGO로 C 라이브러리 사용**
- 장점: Go 유지
- 단점: 빌드 복잡, 크로스컴파일 어려움, 메모리 관리
- 추천: 비추천

**대안 4: Go + Python 하이브리드 (선택)**
- 장점: 성능 + 호환성 모두 확보
- 단점: 운영 복잡도
- 추천: **권장**

---

## 4. 결론 및 권고사항

### 4.1 최종 결론

**Go + Python 하이브리드 아키텍처를 권장합니다.**

주요 근거:
1. SEED/ARIA 암호화는 Python으로만 안정적 구현 가능
2. 핵심 API 성능은 Go로 확보
3. 개발 기간 3-4주 단축
4. 운영 복잡도는 Kubernetes로 관리 가능

### 4.2 권고사항

| 항목 | 권고 |
|------|------|
| 주 언어 | Go 1.22+ |
| 보조 언어 | Python 3.11+ |
| 통신 | gRPC (HTTP/2) |
| 배포 | Kubernetes |
| Python 비율 | 전체 코드의 10% 이내 유지 |

### 4.3 코드베이스 분포 예상

```
전체 코드베이스: 100%

Go (90%):
├── cmd/                 5%
├── internal/           60%
│   ├── domain/        10%
│   ├── service/       20%
│   ├── repository/    10%
│   ├── handler/       15%
│   └── middleware/     5%
├── pkg/               10%
└── api/proto/          5%

Python (10%):
├── shared/crypto/      3%
├── tax-scraper/        4%
└── insurance-edi/      3%
```

### 4.4 향후 고려사항

1. **Go SEED 라이브러리 등장 시**: Python 서비스 단계적 마이그레이션 검토
2. **홈택스 공식 API 제공 시**: 스크래핑 → API 전환
3. **4대보험 표준 API 제공 시**: EDI → API 전환

---

## 부록: 참고 자료

### A. Go 암호화 관련 이슈

- Go crypto/aes: AES만 지원, SEED 미지원
- [KISA SEED 명세](https://seed.kisa.or.kr/)
- Go CGO 한계: 크로스컴파일, 메모리 관리

### B. Python 암호화 라이브러리

- pycryptodome: SEED, ARIA 지원
- cryptography: PKCS#7, X.509 지원
- kisa-seed: KISA 공식 SEED Python 래퍼

### C. 벤치마크 환경

- CPU: Apple M1 Pro
- RAM: 16GB
- OS: macOS 14
- Go: 1.22.0
- Python: 3.11.7

---

**문서 끝**
